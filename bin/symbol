#!/usr/bin/env bash

set -euo pipefail

which fzf > /dev/null || {
    echo "fzf not installed! Get it at https://github.com/junegunn/fzf"
    exit 1
}

SYMBOL_DB=$(cat << HEREDOC
α ::: α – alpha
β ::: β – beta
γ ::: γ – gamma
δ ::: δ – delta
ε ::: ε – epsilon
ζ ::: ζ – zeta
η ::: η – eta
θ ::: θ – theta
ϑ ::: ϑ – vartheta
ι ::: ι – iota
κ ::: κ – kappa
λ ::: λ – lambda
μ ::: μ – mu
ν ::: ν – nu
ξ ::: ξ – xi
π ::: π – pi
ρ ::: ρ – rho
σ ::: σ – sigma
ς ::: ς – varsigma
τ ::: τ – tau
υ ::: υ – upsilon
ϕ ::: ϕ – phi
φ ::: φ – varphi
χ ::: χ – chi
ψ ::: ψ – psi
ω ::: ω – omega

Γ ::: Γ – Gamma
Δ ::: Δ – Delta
Θ ::: Θ – Theta
Λ ::: Λ – Lambda
Ξ ::: Ξ – Xi
Π ::: Π – Pi
Σ ::: Σ – Sigma
Φ ::: Φ – Phi
Ψ ::: Ψ – Psi
Ω ::: Ω – Omega

ℕ ::: ℕ – natural  \mathbb N
ℤ ::: ℤ – integer  \mathbb Z
ℚ ::: ℚ – rational \mathbb Q
ℝ ::: ℝ – reals    \mathbb R

≠ ::: ≠ – neq
≈ ::: ≈ – approx
⊥ ::: ⊥ – bottom
· ::: · – cdot
∘ ::: ∘ – circ
≅ ::: ≅ – cong
≡ ::: ≡ – equivalent
∃ ::: ∃ – exists
∀ ::: ∀ – forall
≥ ::: ≥ – geq >=
∈ ::: ∈ – in
∞ ::: ∞ – infty
≠ ::: ≠ – neq <=
∋ ::: ∋ – ni
¬ ::: ¬ – not
∉ ::: ∉ – not in element
⨁ ::: ⨁ – oplus
⨂ ::: ⨂ – otimes
⊏ ::: ⊏ – sqsubset
⊑ ::: ⊑ – sqsubseteq
⊐ ::: ⊐ – sqsupset
⊒ ::: ⊒ – sqsupseteq
★ ::: ★ – star
⊂ ::: ⊂ – subset
⊆ ::: ⊆ – subseteq
⊊ ::: ⊊ – subsetneq
⊃ ::: ⊃ – supset
⊇ ::: ⊇ – supseteq
⊋ ::: ⊋ – supsetneq
× ::: × – times
∅ ::: ∅ – varnothing
⊢ ::: ⊢ – vdash entails
∨ ::: ∨ – vee
∧ ::: ∧ – wedge
→ ::: → – rightarrow
⇝ ::: ⇝ – rightwards squiggle arrow \rightsquigarrow
␣ ::: ␣ – space

ლ(ಠ益ಠლ) ::: angry emoji – ლ(ಠ益ಠლ)
ᕕ( ᐛ )ᕗ ::: dance emoji – ᕕ( ᐛ )ᕗ
( ͡° ͜ʖ ͡°) ::: sassy emoji – ( ͡° ͜ʖ ͡°)
(╯°□°）╯ ::: upset emoji – (╯°□°）╯
(•_•)     ( •_•)>⌐■-■     (⌐■_■)     YEEEEEAAAAAAAHHHHH ::: yeeeah emoji – (•_•) ( •_•)>⌐■-■ (⌐■_■) YEEEEEAAAAAAAHHHHH
ಠ_ಠ ::: look of disapproval emoji – ಠ_ಠ
ヽ (＾▽＾) ﾉ ::: happy emoji – ヽ (＾▽＾) ﾉ
¯\_(ツ)_/¯ ::: shrug emoji – ¯\_(ツ)_/¯

LaTeχ ::: LaTeχ – latex
ˈkuːχn̩ ::: ˈkuːχn̩ – quchen
Arχiv ::: Arχiv – arxiv

™ ::: ™ – tm, trademark
→ ::: → – ->
⇒ ::: ⇒ – =>
← ::: ← – <-
⇐ ::: ⇐ – <=
✔ ::: ✔ – checkmark
✗ ::: ✗ – crossed out
© ::: © – (c) copyright
® ::: ® – (R) registered
± ::: ± – +-
… ::: … – ...
♥ ::: ♥ – <3 heart
Arχiv ::: Arχiv – Arxiv
‽ ::: ‽ – !? interobang
↯ ::: ↯ – lightning contradiction
☠ ::: ☠ – skull
☃ ::: ☃ – snowman
☭ ::: ☭ – soviet

:t let a x=(x,x);b=a.a;c=b.b in c()                             ::: Ackermann type
?djinn ((a -> r) -> r) -> (a -> (b -> r) -> r) -> (b -> r) -> r ::: Djinn Cont
foldl f z xs  =  foldr (\y go acc -> go (f acc y)) id xs z      ::: foldl via foldr

flip(foldr(ap(flip.(ap.).join.(liftA2 bool.).ap((.).(.).(:))(flip(.).(:)))elem)(const []))[] ::: nub pointfree
HEREDOC
)

list_options() {
    echo "$SYMBOL_DB" | grep -Ev "^(#|$)" | perl -pe 's/\s*:::\s*/:::/'
}

fuzzy_find() {
    cat - | fzf --ansi --no-sort --reverse --with-nth=2.. --delimiter=":::" | perl -pe 's/:::.*$//' | tr -d "\n"
}

list_options "$SYMBOL_DB" | fuzzy_find
